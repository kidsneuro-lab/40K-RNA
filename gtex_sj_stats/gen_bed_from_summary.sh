#!/bin/sh

# STRAND = $5 == 1 ? "+" : "-";

gunzip -c $1 | awk -v OFS="\t" '{
    if ($5 == 1) { STRAND = "+" } else if ($5 == 2) { STRAND = "-" } else { STRAND = "." };
    SCORE = $4 < 10 ? 1 : 999;
    print $1,$2-1,$3,"N_SAMPLES="$4";STRAND="$5";INTRON_MOTIF="$6";ANNO_STATUS="$7";MIN_UNIQ_MAP_READS="$8";Q1_UNIQ_MAP_READS="$9";MEDIAN_UNIQ_MAP_READS="$10";Q3_UNIQ_MAP_READS="$11";MAX_UNIQ_MAP_READS="$12";MEAN_UNIQ_MAP_READS="$13";MIN_MULTI_MAP_READS="$14";Q1_MULTI_MAP_READS="$15";MEDIAN_MULTI_MAP_READS="$16";Q3_MULTI_MAP_READS="$17";MAX_MULTI_MAP_READS="$18";MEAN_MULTI_MAP_READS="$19";Q01_UNIQ_MAP_READS="$20";Q05_UNIQ_MAP_READS="$21";Q95_UNIQ_MAP_READS="$22";Q99_UNIQ_MAP_READS="$23";Q01_MULTI_MAP_READS="$24";Q05_MULTI_MAP_READS="$25";Q95_MULTI_MAP_READS="$26";Q99_MULTI_MAP_READS="$27";SJ_ID="NR,SCORE,STRAND,$2-1,$3,"0,255,255"
}' > $2
